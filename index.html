<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äºŒå¹´çº§è¯­æ–‡èƒŒè¯µé—¯å…³ - ç”·å£°ç‰ˆ</title>
    <style>
        :root {
            --primary-color: #4caf50;
            --primary-hover: #43a047;
            --secondary-color: #2196f3;
            --accent-color: #ff9800;
            --bg-color: #f0f8e6;
            --card-bg: #ffffff;
            --text-main: #333333;
            --text-sub: #666666;
            --success-color: #e8f5e9;
            --success-text: #2e7d32;
            --error-color: #ffebee;
            --error-text: #c62828;
            --note-bg: #fff8e1; /* è®²è§£èƒŒæ™¯è‰²ï¼šæ·¡é»„ */
            --note-border: #ffe082;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --radius: 12px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { 
            font-family: "KaiTi", "æ¥·ä½“", "STKaiti", serif; 
            background: var(--bg-color);
            color: var(--text-main);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        /* ä¸»å®¹å™¨ */
        .app-container {
            width: 100%;
            max-width: 800px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
            overflow: hidden;
            position: relative;
            min-height: 650px;
            display: flex;
            flex-direction: column;
        }
        /* é€šç”¨åŠ¨ç”» */
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .hidden { display: none !important; }
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            border: none;
            border-radius: 30px;
            padding: 12px 30px;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            font-weight: bold;
            box-shadow: 0 4px 0 rgba(0,0,0,0.1);
        }
        .btn:active { transform: translateY(2px); box-shadow: none; }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-primary:hover { background: var(--primary-hover); transform: translateY(-2px); }
        .btn-secondary { background: var(--secondary-color); color: white; }
        .btn-accent { background: var(--accent-color); color: white; }
        .btn-back { 
            position: absolute; 
            top: 20px; 
            left: 20px; 
            background: #eee; 
            color: #555; 
            padding: 8px 15px; 
            font-size: 16px;
            z-index: 10;
        }
        /* é¦–é¡µè§†å›¾ */
        #view-welcome {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 40px;
        }
        .welcome-title { font-size: 36px; margin-bottom: 10px; color: var(--primary-color); }
        .welcome-subtitle { font-size: 22px; color: var(--text-sub); margin-bottom: 40px; }
        .mascot { font-size: 80px; margin-bottom: 20px; animation: bounce 2s infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        /* å…³å¡é€‰æ‹©è§†å›¾ */
        #view-levels { padding: 40px 20px 20px; }
        .header-text { text-align: center; margin-bottom: 20px; font-size: 24px; }
        .progress-container { margin: 20px 0; }
        .progress-label { display: flex; justify-content: space-between; margin-bottom: 5px; font-size: 14px; color: var(--text-sub); }
        .progress-track { height: 12px; background: #e0e0e0; border-radius: 6px; overflow: hidden; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #4caf50, #8bc34a); width: 0%; transition: width 0.6s cubic-bezier(0.4, 0, 0.2, 1); }
        .level-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            padding: 10px;
        }
        .level-card {
            background: var(--card-bg);
            border: 2px solid #eee;
            border-radius: var(--radius);
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            box-shadow: var(--shadow);
        }
        .level-card:hover { border-color: var(--primary-color); transform: translateY(-3px); }
        .level-card.completed { background: var(--success-color); border-color: #81c784; }
        .level-card .status-icon { font-size: 24px; color: #ccc; margin-bottom: 5px; }
        .level-card.completed .status-icon { color: var(--success-text); }
        .level-name { font-size: 16px; font-weight: bold; }
        /* æ¸¸æˆè§†å›¾ */
        #view-game { padding: 60px 20px 20px; display: flex; flex-direction: column; align-items: center; }
        /* æ ‡é¢˜å’Œä½œè€… */
        .game-header { text-align: center; margin-bottom: 15px; width: 100%; }
        .game-title { font-size: 22px; color: var(--text-main); margin-bottom: 5px; }
        .game-author { font-size: 16px; color: #888; font-style: italic; }
        .content-card {
            background: var(--card-bg);
            width: 100%;
            padding: 30px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            text-align: center;
        }
        .poem-text {
            font-size: 22px;
            line-height: 1.8;
            margin-bottom: 20px;
            white-space: pre-wrap; 
        }
        /* è®²è§£åŒºåŸŸ */
        .explanation-card {
            background: var(--note-bg);
            width: 100%;
            padding: 15px 20px;
            border-radius: var(--radius);
            border: 1px solid var(--note-border);
            margin-bottom: 20px;
            position: relative;
        }
        .explanation-label {
            position: absolute;
            top: -10px;
            left: 20px;
            background: var(--accent-color);
            color: white;
            padding: 2px 10px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: bold;
        }
        .explanation-text {
            font-size: 15px;
            color: #5d4037;
            line-height: 1.6;
            margin-top: 5px;
            text-align: justify;
        }
        .question-card {
            width: 100%;
            background: #fff;
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            text-align: left;
        }
        .question-text { font-size: 18px; font-weight: bold; margin-bottom: 15px; border-left: 4px solid var(--accent-color); padding-left: 10px; }
        .options-list { display: flex; flex-direction: column; gap: 10px; }
        .option-item {
            padding: 12px 15px;
            background: #f5f5f5;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 16px;
        }
        .option-item:hover { background: #e0e0e0; }
        .option-item.selected { background: #e3f2fd; border: 2px solid var(--secondary-color); color: var(--secondary-color); font-weight: bold; }
        /* åé¦ˆåŒºåŸŸ */
        .feedback-area {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s;
        }
        .feedback-area.show { opacity: 1; transform: translateY(0); }
        .feedback-area.success { background: var(--success-color); color: var(--success-text); }
        .feedback-area.error { background: var(--error-color); color: var(--error-text); }
        /* Confetti Canvas */
        #confetti-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 99;
        }
        @media (max-width: 480px) {
            .level-grid { grid-template-columns: repeat(2, 1fr); }
            .poem-text { font-size: 18px; }
            .welcome-title { font-size: 28px; }
            .explanation-text { font-size: 14px; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <canvas id="confetti-canvas"></canvas>
        <!-- é¦–é¡µ -->
        <section id="view-welcome" class="fade-in">
            <div class="mascot">ğŸ“š</div>
            <h1 class="welcome-title">ä¹¦å±±æœ‰è·¯å‹¤ä¸ºå¾„</h1>
            <p class="welcome-subtitle">äºŒå¹´çº§è¯­æ–‡èƒŒè¯µé—¯å…³ (ç”·å£°ç‰ˆ)</p>
            <button class="btn btn-primary" onclick="app.showLevels()">å¼€å§‹é—¯å…³</button>
        </section>
        <!-- å…³å¡é€‰æ‹©é¡µ -->
        <section id="view-levels" class="hidden">
            <h2 class="header-text">é€‰æ‹©å…³å¡</h2>
            <div class="progress-container">
                <div class="progress-label">
                    <span>é—¯å…³è¿›åº¦</span>
                    <span id="progress-text">0/15</span>
                </div>
                <div class="progress-track">
                    <div class="progress-bar" id="progress-bar"></div>
                </div>
            </div>
            <div class="level-grid" id="level-list">
                <!-- å…³å¡å¡ç‰‡JSç”Ÿæˆ -->
            </div>
            <div style="text-align: center; margin-top: 30px;">
                <button class="btn btn-secondary" onclick="app.showWelcome()" style="background: #9e9e9e;">è¿”å›é¦–é¡µ</button>
            </div>
        </section>
        <!-- æ¸¸æˆè¯¦æƒ…é¡µ -->
        <section id="view-game" class="hidden">
            <button class="btn btn-back" onclick="app.showLevels()">â† è¿”å›åˆ—è¡¨</button>
            <div class="game-header">
                <h3 id="game-title" class="game-title"></h3>
                <div id="game-author" class="game-author"></div>
            </div>
            <div class="content-card">
                <div id="game-content" class="poem-text"></div>
                <button class="btn btn-secondary" onclick="app.readAloud()">ğŸ”Š ç”·ç”Ÿæœ—è¯»</button>
            </div>
            <!-- è®²è§£å¡ç‰‡ -->
            <div class="explanation-card">
                <div class="explanation-label">ğŸ’¡ è€å¸ˆè®²è§£</div>
                <div id="game-explanation" class="explanation-text"></div>
            </div>
            <div class="question-card">
                <div id="game-question" class="question-text"></div>
                <div id="game-options" class="options-list"></div>
                <div id="feedback-msg" class="feedback-area"></div>
                <button id="submit-btn" class="btn btn-accent" style="width: 100%; margin-top: 15px;" onclick="app.submitAnswer()">æäº¤ç­”æ¡ˆ</button>
            </div>
        </section>
    </div>
    <script>
        // æ¸¸æˆæ•°æ®ï¼ˆåŒ…å«æ‰€æœ‰æ›´æ–°ï¼šä½œè€…ã€è§£é‡Šã€å†…å®¹ï¼‰
        const gameData = [
            { 
                name: 'æ‘å±…', 
                author: '[æ¸…] é«˜é¼',
                content: 'è‰é•¿èºé£äºŒæœˆå¤©ï¼Œæ‹‚å ¤æ¨æŸ³é†‰æ˜¥çƒŸã€‚\nå„¿ç«¥æ•£å­¦å½’æ¥æ—©ï¼Œå¿™è¶ä¸œé£æ”¾çº¸é¸¢ã€‚', 
                explanation: 'è¿™é¦–è¯—æå†™äº†æ˜¥å¤©æ±Ÿå—æ˜åªšçš„æ™¯è‰²ã€‚è‰æœ¨ç”Ÿé•¿ï¼Œé»„èºé£ç¿”ï¼Œæ¨æŸ³åœ¨æ˜¥é›¾ä¸­é™¶é†‰ã€‚å­©å­ä»¬æ”¾å­¦åæ€¥å¿™å›å®¶ï¼Œè¶ç€ä¸œé£å¿«ä¹åœ°æ”¾èµ·äº†é£ç­ã€‚',
                question: 'è¯—ä¸­"å„¿ç«¥æ•£å­¦å½’æ¥æ—©"çš„ä¸‹ä¸€å¥æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['å¿™è¶ä¸œé£æ”¾çº¸é¸¢', 'æ‹‚å ¤æ¨æŸ³é†‰æ˜¥çƒŸ', 'è‰é•¿èºé£äºŒæœˆå¤©'], 
                answer: 0 
            },
            { 
                name: 'å’æŸ³', 
                author: '[å”] è´ºçŸ¥ç« ',
                content: 'ç¢§ç‰å¦†æˆä¸€æ ‘é«˜ï¼Œä¸‡æ¡å‚ä¸‹ç»¿ä¸ç»¦ã€‚\nä¸çŸ¥ç»†å¶è°è£å‡ºï¼ŒäºŒæœˆæ˜¥é£ä¼¼å‰ªåˆ€ã€‚', 
                explanation: 'è¿™æ˜¯ä¸€é¦–èµç¾æŸ³æ ‘çš„è¯—ã€‚é«˜é«˜çš„æŸ³æ ‘é•¿æ»¡äº†ç¿ ç»¿çš„æ–°å¶ï¼Œåƒç¢§ç‰è£…æ‰®çš„ä¸€æ ·ã€‚åƒä¸‡æ¡æŸ³æå‚ä¸‹æ¥åƒç»¿è‰²çš„ä¸å¸¦ã€‚è¿™ç»†ç»†çš„å¶å­æ˜¯è°è£å‡ºæ¥çš„å‘¢ï¼ŸåŸæ¥æ˜¯äºŒæœˆçš„æ˜¥é£åƒå‰ªåˆ€ä¸€æ ·å‰ªå‡ºæ¥çš„ã€‚',
                question: 'è¯—ä¸­"ç¢§ç‰å¦†æˆä¸€æ ‘é«˜"çš„ä¸‹ä¸€å¥æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['ä¸‡æ¡å‚ä¸‹ç»¿ä¸ç»¦', 'ä¸çŸ¥ç»†å¶è°è£å‡º', 'äºŒæœˆæ˜¥é£ä¼¼å‰ªåˆ€'], 
                answer: 0 
            },
            { 
                name: 'èµ‹å¾—å¤åŸè‰é€åˆ«', 
                author: '[å”] ç™½å±…æ˜“',
                content: 'ç¦»ç¦»åŸä¸Šè‰ï¼Œä¸€å²ä¸€æ¯è£ã€‚\né‡ç«çƒ§ä¸å°½ï¼Œæ˜¥é£å¹åˆç”Ÿã€‚\nè¿œèŠ³ä¾µå¤é“ï¼Œæ™´ç¿ æ¥è’åŸã€‚\nåˆé€ç‹å­™å»ï¼Œè‹è‹æ»¡åˆ«æƒ…ã€‚', 
                explanation: 'è¿™é¦–è¯—èµç¾äº†é‡è‰é¡½å¼ºçš„ç”Ÿå‘½åŠ›ã€‚åŸé‡ä¸Šçš„è‰æ¯å¹´éƒ½ä¼šæ¯èä¸€æ¬¡ï¼ŒèŒ‚ç››ä¸€æ¬¡ã€‚é‡ç«è™½ç„¶èƒ½çƒ§æ¯å®ƒçš„å¶å­ï¼Œä½†æ ¹è¿˜åœ¨ï¼Œç¬¬äºŒå¹´æ˜¥é£ä¸€å¹ï¼Œå®ƒåˆé‡æ–°ç”Ÿé•¿å‡ºæ¥äº†ã€‚',
                question: 'è¯—ä¸­"é‡ç«çƒ§ä¸å°½"çš„ä¸‹ä¸€å¥æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['æ˜¥é£å¹åˆç”Ÿ', 'è¿œèŠ³ä¾µå¤é“', 'æ™´ç¿ æ¥è’åŸ'], 
                answer: 0 
            },
            { 
                name: 'ä¼ ç»ŸèŠ‚æ—¥', 
                author: 'è¯¾æ–‡é€‰ç¼–',
                content: 'æ˜¥èŠ‚åˆ°ï¼Œäººæ¬¢ç¬‘ã€‚è´´çª—èŠ±ï¼Œæ”¾é­ç‚®ã€‚\nå…ƒå®µèŠ‚ï¼Œçœ‹èŠ±ç¯ï¼Œå¤§è¡—å°å··äººå¦‚æ½®ã€‚\næ¸…æ˜èŠ‚ï¼Œé›¨çº·çº·ï¼Œå…ˆäººå¢“å‰å»ç¥­æ‰«ã€‚\nè¿‡ç«¯åˆï¼Œèµ›é¾™èˆŸï¼Œç²½å­è‰¾é¦™æ»¡å ‚é£˜ã€‚\nä¸ƒæœˆä¸ƒï¼Œæ¥ä¹å·§ï¼Œç‰›éƒç»‡å¥³ä¼šé¹Šæ¡¥ã€‚\nè¿‡ä¸­ç§‹ï¼Œåƒæœˆé¥¼ï¼Œåäº”åœ†æœˆå½“ç©ºç…§ã€‚\né‡é˜³èŠ‚ï¼Œè¦æ•¬è€ï¼Œè¸ç§‹èµèŠå»ç™»é«˜ã€‚\nè½¬çœ¼åˆæ˜¯æ–°æ˜¥åˆ°ï¼Œå…¨å®¶å›¢åœ†çœŸçƒ­é—¹ã€‚', 
                explanation: 'è¿™æ˜¯ä¸€é¦–ä»‹ç»ä¸­å›½ä¼ ç»ŸèŠ‚æ—¥çš„å„¿æ­Œã€‚æ–‡ä¸­æŒ‰æ—¶é—´é¡ºåºè®²è¿°äº†æ˜¥èŠ‚ã€å…ƒå®µèŠ‚ã€æ¸…æ˜èŠ‚ã€ç«¯åˆèŠ‚ã€ä¸ƒå¤•ã€ä¸­ç§‹èŠ‚å’Œé‡é˜³èŠ‚çš„ä¹ ä¿—ï¼Œè¡¨è¾¾äº†ä¸­åæ–‡åŒ–çš„ä¸°å¯Œå¤šå½©ã€‚',
                question: 'è¯—ä¸­"è¿‡ç«¯åˆï¼Œèµ›é¾™èˆŸ"åé¢æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['ç²½å­è‰¾é¦™æ»¡å ‚é£˜', 'å¤§è¡—å°å··äººå¦‚æ½®', 'å…ˆäººå¢“å‰å»ç¥­æ‰«'], 
                answer: 0 
            },
            { 
                name: 'ç¥å·è°£', 
                author: 'è¯¾æ–‡é€‰ç¼–',
                content: 'æˆ‘ç¥å·ï¼Œç§°ä¸­åï¼Œå±±å·ç¾ï¼Œå¯å…¥ç”»ã€‚\né»„æ²³å¥”ï¼Œé•¿æ±Ÿæ¶Œï¼Œé•¿åŸé•¿ï¼Œç å³°è€¸ã€‚\nå°æ¹¾å²›ï¼Œéš”æµ·å³¡ï¼Œä¸å¤§é™†ï¼Œæ˜¯ä¸€å®¶ã€‚\nå„æ°‘æ—ï¼Œæƒ…è°Šæµ“ï¼Œé½å¥‹å‘ï¼Œå…±ç¹è£ã€‚', 
                explanation: 'è¿™ç¯‡éŸµæ–‡æ­Œé¢‚äº†ç¥–å›½çš„å£®ä¸½æ²³å±±ã€‚é»„æ²³ã€é•¿æ±Ÿå¥”è…¾ä¸æ¯ï¼Œé•¿åŸé•¿ï¼Œç ç©†æœ—ç›å³°é«˜è€¸ã€‚å°æ¹¾æ˜¯æˆ‘ä»¬ä¸å¯åˆ†å‰²çš„ä¸€éƒ¨åˆ†ï¼Œå„æ°‘æ—å›¢ç»“ä¸€å¿ƒï¼Œå…±åŒå‘å±•ã€‚',
                question: 'è¯—ä¸­"é»„æ²³å¥”ï¼Œé•¿æ±Ÿæ¶Œ"åé¢æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['é•¿åŸé•¿ï¼Œç å³°è€¸', 'å°æ¹¾å²›ï¼Œéš”æµ·å³¡', 'å„æ°‘æ—ï¼Œæƒ…è°Šæµ“'], 
                answer: 0 
            },
            { 
                name: 'æ—¥ç§¯æœˆç´¯ï¼ˆä¸€ï¼‰', 
                author: 'è°šè¯­',
                content: 'äºˆäººç«ç‘°ï¼Œæ‰‹æœ‰ä½™é¦™ã€‚\nå¹³æ—¶è‚¯å¸®äººï¼Œæ€¥æ—¶æœ‰äººå¸®ã€‚\nä¸å…¶é”¦ä¸Šæ·»èŠ±ï¼Œä¸å¦‚é›ªä¸­é€ç‚­ã€‚', 
                explanation: '"äºˆäººç«ç‘°ï¼Œæ‰‹æœ‰ä½™é¦™"çš„æ„æ€æ˜¯ï¼šå¸®åŠ©åˆ«äººï¼Œè‡ªå·±ä¹Ÿä¼šæ„Ÿåˆ°å¿«ä¹ã€‚"é›ªä¸­é€ç‚­"æ¯”å–»åœ¨åˆ«äººæ€¥éœ€æ—¶ç»™ä»¥ç‰©è´¨ä¸Šæˆ–ç²¾ç¥ä¸Šçš„å¸®åŠ©ã€‚',
                question: '"äºˆäººç«ç‘°ï¼Œæ‰‹æœ‰ä½™é¦™"çš„æ„æ€æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['å¸®åŠ©åˆ«äººè‡ªå·±ä¹Ÿä¼šå¿«ä¹', 'ç«ç‘°å¾ˆé¦™', 'é€äººç«ç‘°å¾ˆè´µ'], 
                answer: 0 
            },
            { 
                name: 'æ—¥ç§¯æœˆç´¯ï¼ˆäºŒï¼‰', 
                author: 'ã€Šå·¦ä¼ ã€‹',
                content: 'å¤±ä¿¡ä¸ç«‹ã€‚\nå°ä¿¡æˆåˆ™å¤§ä¿¡ç«‹ã€‚', 
                explanation: '"å¤±ä¿¡ä¸ç«‹"çš„æ„æ€æ˜¯è¯´ï¼Œä¸è®²ä¿¡ç”¨çš„äººå°±æ— æ³•åœ¨ç¤¾ä¼šä¸Šç«‹è¶³ã€‚"å°ä¿¡æˆåˆ™å¤§ä¿¡ç«‹"æ„æ€æ˜¯å°äº‹æƒ…è®²ä¿¡ç”¨ï¼Œå°±èƒ½å»ºç«‹èµ·å¤§çš„ä¿¡ç”¨ï¼Œåšäººè¦è¯šå®å®ˆä¿¡ã€‚',
                question: '"å°ä¿¡æˆåˆ™å¤§ä¿¡ç«‹"çš„æ„æ€æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['å°äº‹æƒ…å®ˆä¿¡ç”¨ï¼Œå¤§äº‹æƒ…ä¹Ÿä¼šå®ˆä¿¡ç”¨', 'å°äº‹æƒ…ä¸é‡è¦', 'å¤§äº‹æƒ…æ‰é‡è¦'], 
                answer: 0 
            },
            { 
                name: 'æ™“å‡ºå‡€æ…ˆå¯ºé€æ—å­æ–¹', 
                author: '[å®‹] æ¨ä¸‡é‡Œ',
                content: 'æ¯•ç«Ÿè¥¿æ¹–å…­æœˆä¸­ï¼Œé£å…‰ä¸ä¸å››æ—¶åŒã€‚\næ¥å¤©è²å¶æ— ç©·ç¢§ï¼Œæ˜ æ—¥è·èŠ±åˆ«æ ·çº¢ã€‚', 
                explanation: 'è¿™é¦–è¯—æå†™äº†è¥¿æ¹–å…­æœˆç¾ä¸½çš„é£å…‰ã€‚è²å¶æ— è¾¹æ— é™…ï¼Œä¸å¤©ç›¸æ¥ï¼Œä¸€ç‰‡ç¢§ç»¿ï¼›è·èŠ±åœ¨é˜³å…‰çš„ç…§è€€ä¸‹ï¼Œæ˜¾å¾—æ ¼å¤–é²œè‰³å¨‡çº¢ã€‚',
                question: 'è¯—ä¸­"æ¥å¤©è²å¶æ— ç©·ç¢§"çš„ä¸‹ä¸€å¥æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['æ˜ æ—¥è·èŠ±åˆ«æ ·çº¢', 'æ¯•ç«Ÿè¥¿æ¹–å…­æœˆä¸­', 'é£å…‰ä¸ä¸å››æ—¶åŒ'], 
                answer: 0 
            },
            { 
                name: 'ç»å¥', 
                author: '[å”] æœç”«',
                content: 'ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³ï¼Œä¸€è¡Œç™½é¹­ä¸Šé’å¤©ã€‚\nçª—å«è¥¿å²­åƒç§‹é›ªï¼Œé—¨æ³Šä¸œå´ä¸‡é‡Œèˆ¹ã€‚', 
                explanation: 'è¿™é¦–è¯—æç»˜äº†è‰å ‚å‘¨å›´æ˜åªšç§€ä¸½çš„æ˜¥å¤©æ™¯è‰²ã€‚é»„é¹‚åœ¨ç¿ ç»¿çš„æŸ³æ ‘ä¸Šé¸£å«ï¼Œç™½é¹­é£ä¸Šè“å¤©ã€‚çª—å£å¯ä»¥çœ‹åˆ°è¥¿å²­åƒå¹´ä¸åŒ–çš„ç§¯é›ªï¼Œé—¨å¤–åœæ³Šç€æ¥è‡ªä¸œå´çš„èˆ¹åªã€‚',
                question: 'è¯—ä¸­"ä¸¤ä¸ªé»„é¹‚é¸£ç¿ æŸ³"çš„ä¸‹ä¸€å¥æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['ä¸€è¡Œç™½é¹­ä¸Šé’å¤©', 'çª—å«è¥¿å²­åƒç§‹é›ª', 'é—¨æ³Šä¸œå´ä¸‡é‡Œèˆ¹'], 
                answer: 0 
            },
            { 
                name: 'é›·é›¨', 
                author: 'è¯¾æ–‡é€‰ç¼–',
                content: 'æ»¡å¤©çš„ä¹Œäº‘ï¼Œé»‘æ²‰æ²‰åœ°å‹ä¸‹æ¥ã€‚\næ ‘ä¸Šçš„å¶å­ä¸€åŠ¨ä¸åŠ¨ï¼Œè‰ä¸€å£°ä¹Ÿä¸å«ã€‚\nå¿½ç„¶ä¸€é˜µå¤§é£ï¼Œå¹å¾—æ ‘æä¹±æ‘†ã€‚\nä¸€åªèœ˜è››ä»ç½‘ä¸Šå‚ä¸‹æ¥ï¼Œé€ƒèµ°äº†ã€‚', 
                explanation: 'è¿™æ®µè¯æå†™äº†é›·é›¨å‰çš„æ™¯è±¡ã€‚ä¹Œäº‘å¯†å¸ƒï¼Œç©ºæ°”é—·çƒ­ï¼Œæ²¡æœ‰ä¸€ä¸é£ã€‚å¿½ç„¶åˆ®èµ·äº†å¤§é£ï¼Œæ ‘æä¹±æ‘†ï¼Œè¿èœ˜è››éƒ½å“å¾—é€ƒèµ°äº†ï¼Œè¯´æ˜å¤§é›¨é©¬ä¸Šå°±è¦æ¥äº†ã€‚',
                question: 'æ–‡ä¸­"å¿½ç„¶ä¸€é˜µå¤§é£"åé¢å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ', 
                options: ['å¹å¾—æ ‘æä¹±æ‘†', 'è‰ä¸€å£°ä¹Ÿä¸å«', 'æ»¡å¤©çš„ä¹Œäº‘'], 
                answer: 0 
            },
            { 
                name: 'æ‚¯å†œ', 
                author: '[å”] æç»…',
                content: 'é”„ç¦¾æ—¥å½“åˆï¼Œæ±—æ»´ç¦¾ä¸‹åœŸã€‚\nè°çŸ¥ç›˜ä¸­é¤ï¼Œç²’ç²’çš†è¾›è‹¦ã€‚', 
                explanation: 'è¿™é¦–è¯—å‘Šè¯‰æˆ‘ä»¬å†œæ°‘ç§ç”°å¾ˆè¾›è‹¦ã€‚æ­£åˆæ—¶åˆ†ï¼Œå†œæ°‘è¿˜åœ¨ç”°é‡Œé”„è‰ï¼Œæ±—æ°´æ»´åˆ°ç¦¾è‹—ä¸‹çš„åœŸé‡Œã€‚æˆ‘ä»¬ç¢—é‡Œçš„ç±³é¥­ï¼Œæ¯ä¸€ç²’éƒ½åŒ…å«äº†å†œæ°‘çš„è¾›è‹¦ï¼Œæ‰€ä»¥è¦çæƒœç²®é£Ÿã€‚',
                question: 'è¯—ä¸­"é”„ç¦¾æ—¥å½“åˆ"çš„ä¸‹ä¸€å¥æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['æ±—æ»´ç¦¾ä¸‹åœŸ', 'è°çŸ¥ç›˜ä¸­é¤', 'ç²’ç²’çš†è¾›è‹¦'], 
                answer: 0 
            },
            { 
                name: 'äºŒåå››èŠ‚æ°”æ­Œ', 
                author: 'å†œè°š',
                content: 'æ˜¥é›¨æƒŠæ˜¥æ¸…è°·å¤©ï¼Œå¤æ»¡èŠ’å¤æš‘ç›¸è¿ã€‚\nç§‹å¤„éœ²ç§‹å¯’éœœé™ï¼Œå†¬é›ªé›ªå†¬å°å¤§å¯’ã€‚', 
                explanation: 'è¿™æ˜¯ä¸ºäº†ä¾¿äºè®°å¿†äºŒåå››èŠ‚æ°”è€Œç¼–æˆçš„æ­Œè¯€ã€‚å®ƒæŒ‰é¡ºåºåŒ…å«äº†æ˜¥ã€å¤ã€ç§‹ã€å†¬å››å­£çš„äºŒåå››ä¸ªèŠ‚æ°”ï¼Œæ¯”å¦‚ç«‹æ˜¥ã€é›¨æ°´ã€æ¸…æ˜ã€å†¬è‡³ç­‰ï¼ŒæŒ‡å¯¼å†œä¸šç”Ÿäº§ã€‚',
                question: '"æ˜¥é›¨æƒŠæ˜¥æ¸…è°·å¤©"åŒ…å«å“ªäº›èŠ‚æ°”ï¼Ÿ', 
                options: ['ç«‹æ˜¥ã€é›¨æ°´ã€æƒŠè›°ã€æ˜¥åˆ†ã€æ¸…æ˜ã€è°·é›¨', 'å¤æ»¡èŠ’å¤æš‘ç›¸è¿', 'ç§‹å¤„éœ²ç§‹å¯’éœœé™'], 
                answer: 0 
            },
            { 
                name: 'èˆŸå¤œä¹¦æ‰€è§', 
                author: '[æ¸…] æŸ¥æ…è¡Œ',
                content: 'æœˆé»‘è§æ¸”ç¯ï¼Œå­¤å…‰ä¸€ç‚¹è¤ã€‚\nå¾®å¾®é£ç°‡æµªï¼Œæ•£ä½œæ»¡æ²³æ˜Ÿã€‚', 
                explanation: 'è¿™é¦–è¯—æå†™äº†å¤œæ™šæ±Ÿä¸Šçš„æ™¯è‰²ã€‚æ¼†é»‘çš„å¤œé‡Œï¼Œçœ‹è§ä¸€ç›æ¸”ç¯ï¼Œåƒè¤ç«è™«ä¸€æ ·å¾®å¼±ã€‚å¾®é£å¹èµ·æ³¢æµªï¼Œç¯å…‰å€’æ˜ åœ¨æ°´é¢ï¼Œæ•£å¼€åƒæ»¡æ²³çš„æ˜Ÿæ˜Ÿã€‚',
                question: 'è¯—ä¸­"æœˆé»‘è§æ¸”ç¯"çš„ä¸‹ä¸€å¥æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['å­¤å…‰ä¸€ç‚¹è¤', 'å¾®å¾®é£ç°‡æµª', 'æ•£ä½œæ»¡æ²³æ˜Ÿ'], 
                answer: 0 
            },
            { 
                name: 'å¼Ÿå­è§„', 
                author: '[æ¸…] ææ¯“ç§€',
                content: 'å¼Ÿå­è§„ï¼Œåœ£äººè®­ã€‚\né¦–å­æ‚Œï¼Œæ¬¡è§é—»ã€‚\nçŸ¥æŸæ•°ï¼Œè¯†æŸæ–‡ã€‚', 
                explanation: 'ã€Šå¼Ÿå­è§„ã€‹æ˜¯å¯è’™å…»æ­£çš„å¥½è¯»ç‰©ã€‚è¿™å‡ å¥çš„æ„æ€æ˜¯ï¼šå¼Ÿå­è§„æ˜¯ä¾æ®åœ£äººçš„æ•™è¯²ç¼–æˆçš„ã€‚é¦–å…ˆè¦å­¦ä¼šå­é¡ºçˆ¶æ¯ã€å‹çˆ±å…„å¼Ÿå§å¦¹ï¼Œå…¶æ¬¡è¦å­¦ä¹ çœ‹åˆ°å’Œå¬åˆ°çš„çŸ¥è¯†ï¼Œè¿˜è¦å­¦ä¹ ç®—æœ¯å’Œæ–‡å­—ã€‚',
                question: '"å¼Ÿå­è§„ï¼Œåœ£äººè®­"çš„ä¸‹ä¸€å¥æ˜¯ä»€ä¹ˆï¼Ÿ', 
                options: ['é¦–å­æ‚Œï¼Œæ¬¡è§é—»', 'çŸ¥æŸæ•°ï¼Œè¯†æŸæ–‡', 'å¼Ÿå­è§„ï¼Œåœ£äººè®­'], 
                answer: 0 
            }
        ];
        const app = {
            state: {
                currentView: 'welcome',
                completedLevels: [],
                currentLevelIndex: 0,
                selectedOption: null
            },
            init() {
                const savedProgress = localStorage.getItem('chineseGameProgress');
                if (savedProgress) {
                    this.state.completedLevels = JSON.parse(savedProgress);
                }
                this.renderLevels();
            },
            saveProgress() {
                localStorage.setItem('chineseGameProgress', JSON.stringify(this.state.completedLevels));
                this.renderLevels();
            },
            switchView(viewId) {
                ['view-welcome', 'view-levels', 'view-game'].forEach(id => {
                    document.getElementById(id).classList.add('hidden');
                });
                document.getElementById(viewId).classList.remove('hidden');
                document.getElementById(viewId).classList.add('fade-in');
            },
            showWelcome() {
                this.switchView('view-welcome');
            },
            showLevels() {
                this.updateProgressUI();
                this.switchView('view-levels');
            },
            startLevel(index) {
                this.state.currentLevelIndex = index;
                this.state.selectedOption = null;
                const level = gameData[index];
                // æ›´æ–°æ ‡é¢˜å’Œä½œè€…
                document.getElementById('game-title').innerText = level.name;
                document.getElementById('game-author').innerText = level.author;
                // æ›´æ–°å†…å®¹å’Œè®²è§£
                document.getElementById('game-content').innerText = level.content;
                document.getElementById('game-explanation').innerText = level.explanation;
                document.getElementById('game-question').innerText = `é¢˜ç›®ï¼š${level.question}`;
                // é‡ç½®UI
                const feedbackEl = document.getElementById('feedback-msg');
                feedbackEl.className = 'feedback-area';
                feedbackEl.innerText = '';
                const submitBtn = document.getElementById('submit-btn');
                submitBtn.disabled = false;
                submitBtn.innerText = 'æäº¤ç­”æ¡ˆ';
                submitBtn.style.opacity = '1';
                // ç”Ÿæˆé€‰é¡¹
                const optionsContainer = document.getElementById('game-options');
                optionsContainer.innerHTML = '';
                level.options.forEach((opt, idx) => {
                    const el = document.createElement('div');
                    el.className = 'option-item';
                    el.innerText = opt;
                    el.onclick = () => this.selectOption(idx, el);
                    optionsContainer.appendChild(el);
                });
                this.switchView('view-game');
            },
            selectOption(index, element) {
                document.querySelectorAll('.option-item').forEach(el => el.classList.remove('selected'));
                element.classList.add('selected');
                this.state.selectedOption = index;
            },
            submitAnswer() {
                const level = gameData[this.state.currentLevelIndex];
                const feedbackEl = document.getElementById('feedback-msg');
                const submitBtn = document.getElementById('submit-btn');
                if (this.state.selectedOption === null) {
                    this.showFeedback('è¯·å…ˆé€‰æ‹©ä¸€ä¸ªç­”æ¡ˆï¼', 'error');
                    return;
                }
                if (this.state.selectedOption === level.answer) {
                    this.showFeedback(`æ­å–œé€šè¿‡ï¼è·å¾—"${level.name}å°èƒ½æ‰‹"å¾½ç« ï¼`, 'success');
                    submitBtn.disabled = true;
                    submitBtn.innerText = 'å·²é€šå…³';
                    submitBtn.style.opacity = '0.6';
                    if (!this.state.completedLevels.includes(this.state.currentLevelIndex)) {
                        this.state.completedLevels.push(this.state.currentLevelIndex);
                        this.saveProgress();
                        fireConfetti();
                    }
                    setTimeout(() => {
                        this.showLevels();
                    }, 2000);
                } else {
                    this.showFeedback('ç­”æ¡ˆä¸å¯¹ï¼Œå†è¯•ä¸€æ¬¡ï¼', 'error');
                    document.querySelector('.content-card').animate([
                        { transform: 'translateX(0)' },
                        { transform: 'translateX(-10px)' },
                        { transform: 'translateX(10px)' },
                        { transform: 'translateX(0)' }
                    ], { duration: 300 });
                }
            },
            showFeedback(msg, type) {
                const el = document.getElementById('feedback-msg');
                el.innerText = msg;
                el.className = `feedback-area show ${type}`;
            },
            readAloud() {
                const level = gameData[this.state.currentLevelIndex];
                if ('speechSynthesis' in window) {
                    const utterance = new SpeechSynthesisUtterance(level.content);
                    utterance.lang = 'zh-CN';
                    // --- å…³é”®ä¿®æ”¹å¼€å§‹ ---
                    // 1. å°è¯•è·å–ç”·å£°
                    const voices = window.speechSynthesis.getVoices();
                    let maleVoice = null;
                    // ç­–ç•¥A: ä¼˜å…ˆå¯»æ‰¾æ˜ç¡®å¸¦æœ‰ "Male" æˆ– "Kangkang" (Windowså¸¸è§ç”·å£°) çš„è¯­éŸ³
                    maleVoice = voices.find(v => 
                        (v.name.includes('Male') || v.name.includes('Kangkang')) && 
                        v.lang.includes('zh')
                    );
                    // ç­–ç•¥B: å¦‚æœæ²¡æ‰¾åˆ°æ˜ç¡®ç”·å£°ï¼Œå°è¯•ç­›é€‰æ‰å¸¸è§çš„å¥³å£°åå­—
                    if (!maleVoice) {
                        const commonFemaleNames = ['Huihui', 'Yaoyao', 'Xiaoxiao', 'Ting-Ting', 'Mei-Jia'];
                        maleVoice = voices.find(v => 
                            v.lang.includes('zh') && 
                            !commonFemaleNames.some(name => v.name.includes(name))
                        );
                    }
                    // ç­–ç•¥C: é™çº§ä½¿ç”¨ä»»æ„ä¸­æ–‡è¯­éŸ³
                    if (!maleVoice) {
                        maleVoice = voices.find(v => v.lang.includes('zh'));
                    }
                    if (maleVoice) {
                        utterance.voice = maleVoice;
                    }
                    // 2. è°ƒæ•´è¯­è°ƒå‚æ•°ä»¥æ¨¡æ‹Ÿ"æŠ‘æ‰¬é¡¿æŒ«"å’Œ"ç”·æ€§æ„Ÿ"
                    // è¯­é€Ÿ 0.8: ç¨å¾®æ”¾æ…¢ï¼Œæœ‰åŠ©äºä½“ç°è¯—è¯çš„éŸµå¾‹æ„Ÿï¼Œé¿å…åƒèµ¶æ—¶é—´
                    utterance.rate = 0.8; 
                    // éŸ³è°ƒ 0.9: æ¯”é»˜è®¤ç•¥ä½ï¼Œå£°éŸ³å¬èµ·æ¥æ›´æµ‘åšæ²‰ç¨³ï¼Œé€‚åˆç”·å£°å’Œå¤è¯—æ°›å›´
                    utterance.pitch = 0.9;
                    // --- å…³é”®ä¿®æ”¹ç»“æŸ ---
                    window.speechSynthesis.cancel();
                    window.speechSynthesis.speak(utterance);
                } else {
                    alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒæœ—è¯»åŠŸèƒ½');
                }
            },
            renderLevels() {
                const container = document.getElementById('level-list');
                container.innerHTML = '';
                gameData.forEach((level, index) => {
                    const isCompleted = this.state.completedLevels.includes(index);
                    const card = document.createElement('div');
                    card.className = `level-card ${isCompleted ? 'completed' : ''}`;
                    card.onclick = () => this.startLevel(index);
                    card.innerHTML = `
                        <div class="status-icon">${isCompleted ? 'ğŸŒŸ' : 'ğŸ”’'}</div>
                        <div class="level-name">${level.name}</div>
                    `;
                    container.appendChild(card);
                });
                this.updateProgressUI();
            },
            updateProgressUI() {
                const total = gameData.length;
                const completed = this.state.completedLevels.length;
                const percent = (completed / total) * 100;
                document.getElementById('progress-text').innerText = `${completed}/${total}`;
                document.getElementById('progress-bar').style.width = `${percent}%`;
            }
        };
        // Confetti Logic
        const canvas = document.getElementById('confetti-canvas');
        const ctx = canvas.getContext('2d');
        let particles = [];
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();
        function fireConfetti() {
            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: window.innerWidth / 2,
                    y: window.innerHeight / 2,
                    vx: (Math.random() - 0.5) * 20,
                    vy: (Math.random() - 0.5) * 20 - 5,
                    life: 100 + Math.random() * 50,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    size: Math.random() * 5 + 5
                });
            }
            requestAnimationFrame(updateConfetti);
        }
        function updateConfetti() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particles.length; i++) {
                let p = particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.vy += 0.5; 
                p.life--;
                p.size *= 0.96;
                ctx.fillStyle = p.color;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
                if (p.life <= 0 || p.size < 0.5) {
                    particles.splice(i, 1);
                    i--;
                }
            }
            if (particles.length > 0) {
                requestAnimationFrame(updateConfetti);
            }
        }
        app.init();
    </script>
</body>
</html>
